- name: ensure eclipse base directory exists
  file: dest="{{ eclipse_base_dir }}"
        state=directory
        owner="{{ eclipse_owner }}"
        group="{{ eclipse_group }}"

- name: ensure eclipse installer directory exists
  file: dest="{{ eclipse_base_dir }}/installer"
        state=directory
        owner="{{ eclipse_owner }}"
        group="{{ eclipse_group }}"

- name: ensure eclipse installer package is downloaded
  get_url: url="{{ eclipse_installer_url }}"
           dest="{{ eclipse_base_dir }}/installer.tar.gz"

- name: ensure eclipse installer package is unpacked
  unarchive: src="{{ eclipse_base_dir }}/installer.tar.gz"
             dest="{{ eclipse_base_dir }}/installer"
             copy=no
             owner="{{ eclipse_owner }}"
             group="{{ eclipse_group }}"
             creates="{{ eclipse_base_dir }}/installer/eclipse"
  sudo: yes
  sudo_user: "{{ eclipse_owner }}"

- name: ensure desktop file for eclipse installer is installed
  copy: src=eclipse-installer.desktop
        dest=/usr/share/applications/eclipse-installer.desktop
        owner=root group=root mode=0644

- name: ensure setup file for eclipse is installed
  copy: src={{ item }}
        dest="{{ eclipse_base_dir }}/{{ item }}"
        owner="{{ eclipse_owner }}"
        group="{{ eclipse_group }}"
  with_items:
    - EclipseJava.setup
    - EclipsePHP.setup

- name: ensure port 9000 for php debugging is open in internal zone
  firewalld: port=9000/tcp permanent=true zone=internal state=enabled
